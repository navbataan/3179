{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "Top & Bottom Victorian LGAs by Population Density (people/km^2)",
    "subtitle": "Grouped by population density category (2024)",
    "anchor": "start",
    "fontSize": 16
  },
  "width": 500,
  "height": 500,
  "data": {
    "url": "https://raw.githubusercontent.com/navbataan/3179/main/centroids_clean.csv"
  },
  "transform": [
    {
      "calculate": "datum.pop_densit < 1000 ? 'Low Density' : datum.pop_densit < 3000 ? 'Medium Density' : 'High Density'",
      "as": "Density_Group"
    },
    {
      "window": [{"op": "rank", "as": "rank"}],
      "sort": [{"field": "pop_densit", "order": "descending"}]
    },
    {
      "filter": "datum.rank <= 10 || datum.rank >= (datum.total - 10)"
    }
  ],
  "mark": {
    "type": "bar",
    "opacity": 1.0
  },
  "encoding": {
    "y": {
      "field": "lga_name_2",
      "type": "ordinal",
      "sort": "-x",
      "title": "Local Government Area",
      "axis": {"labelFontSize": 10}
    },
    "x": {
      "field": "pop_densit",
      "type": "quantitative",
      "title": "Population Density (people/km^2)",
      "axis": {"grid": true}
    },
    "color": {
      "field": "Density_Group",
      "type": "nominal",
      "title": "Density Category",
      "scale": {"range": ["#e8f5e9", "#81c784", "#1b5e20"]}
    },
    "tooltip": [
      {"field": "lga_name_2", "title": "LGA"},
      {"field": "Green_Pct", "title": "Green Space (%)", "format": ".1f"},
      {"field": "pop_densit", "title": "Population Density (people/kmÂ²)", "format": ",.0f"},
      {"field": "Density_Group", "title": "Density Category"}
    ]
  }
}
